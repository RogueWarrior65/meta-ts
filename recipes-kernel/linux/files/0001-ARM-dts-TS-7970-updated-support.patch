From 82a4588de60185590654f8576c1de271da8dc21c Mon Sep 17 00:00:00 2001
From: Kris Bahnsen <kris@embeddedarm.com>
Date: Tue, 14 Dec 2021 10:51:55 -0800
Subject: [PATCH 1/2] ARM: dts: TS-7970 updated support

Based on commit ad2875c66161988193976eccaa22b82f4e853dd5 from
https://github.com/embeddedarm/linux-tsimx/

Patched to better support upstream 5.10 kernel
---
 arch/arm/boot/dts/imx6qdl-ts7970.dtsi | 38 +++++++++++++++++++++++++++++++++--
 1 file changed, 36 insertions(+), 2 deletions(-)

diff --git a/arch/arm/boot/dts/imx6qdl-ts7970.dtsi b/arch/arm/boot/dts/imx6qdl-ts7970.dtsi
index e6aa0c33754d..fbbccb5523b3 100644
--- a/arch/arm/boot/dts/imx6qdl-ts7970.dtsi
+++ b/arch/arm/boot/dts/imx6qdl-ts7970.dtsi
@@ -44,6 +44,14 @@
 #include <dt-bindings/interrupt-controller/irq.h>
 
 / {
+	chosen {
+		stdout-path = &uart1;
+	};
+
+	aliases {
+		ethernet0 = &fec;
+	};
+
 	leds {
 		pinctrl-names = "default";
 		pinctrl-0 = <&pinctrl_leds1>;
@@ -84,7 +92,6 @@
 			gpios = <&gpio5 17 GPIO_ACTIVE_HIGH>;
 			default-state = "off";
 		};
-
 	};
 
 	reg_3p3v: regulator-3p3v {
@@ -186,6 +193,30 @@
 	pinctrl-names = "default";
 	pinctrl-0 = <&pinctrl_ecspi2>;
 	status = "okay";
+
+	serial1: max3100-0@0 {
+		compatible = "max3100-ts";
+		reg = <0>;
+		interrupt-parent = <&gpio1>;
+		interrupts = <4 IRQ_TYPE_LEVEL_LOW>;
+		spi-max-frequency = <1000000>;
+		loopback = <0>;
+		crystal = <1>;
+		poll-time = <100>;
+		fifo-size = <16>;
+	};
+
+	spidevfpga: spi@1 {
+		compatible = "spidev";
+		reg = <1>;
+		spi-max-frequency = <1000000>;
+	};
+
+	spidevhd1: spi@2 {
+		compatible = "spidev";
+		reg = <2>;
+		spi-max-frequency = <1000000>;
+	};
 };
 
 &fec {
@@ -199,6 +230,7 @@
 };
 
 &hdmi {
+	ddc-i2c-bus = <&i2c2>;
 	status = "okay";
 };
 
@@ -226,7 +258,8 @@
 		reg = <0x28>;
 		#gpio-cells = <2>;
 		gpio-controller;
-		ngpio = <32>;
+		ngpio = <64>;
+		base = <224>;
 	};
 
 	sgtl5000: codec@a {
@@ -498,6 +531,7 @@
 };
 
 &pcie {
+	reset-gpio = <&gpio2 21 0>;
 	status = "okay";
 };
 
-- 
2.11.0

